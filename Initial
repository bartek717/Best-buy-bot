import time
from selenium import webdriver
import smtplib
EMAIL_ADDRESS = "********"
EMAIL_PASSWORD = "*****"
subject = "This  "
body = "One of the graphics cards went up go grab it"
msg = f'Subject : {subject}\n\n{body}'

browser = webdriver.Chrome("C:\webdrivers/chromedriver")

# 1660 super page (out of stock)
browser.get("https://www.bestbuy.ca/en-ca/product/asus-tuf-gaming-geforce-gtx-1660-super-oc-6gb-ddr6-video-card/14969729")

# safe page (in stock button)
# browser.get("https://www.bestbuy.ca/en-ca/product/logitech-g305-12000-dpi-wireless-optical-gaming-mouse-black/12642295")

# browser.get("https://www.bestbuy.ca/en-ca/product/insignia-43-1080p-hd-led-tv-ns-43d420na20-only-at-best-buy/14500009")

buybutton = False
with smtplib.SMTP("smtp.gmail.com", 587) as smtp:
    smtp.ehlo()
    smtp.starttls()
    smtp.ehlo()
    smtp.login(EMAIL_ADDRESS, EMAIL_PASSWORD)

    while not buybutton:
        # check if the button is available via searching for class name
        TheButtonItself = browser.find_element_by_xpath("//*[@id=\"test\"]/button").is_enabled()
        if not TheButtonItself:
            # button is not ready
            print("button is not ready yet")

            # refresh
            time.sleep(5)
            browser.refresh()

        elif TheButtonItself:
            smtp.sendmail(EMAIL_ADDRESS, "************", msg)



